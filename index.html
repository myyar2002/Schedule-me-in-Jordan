<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>دليل الرحلات الأردني المطور | Jordan Travel Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        jordanGreen: '#006B3C',
                        jordanRed: '#CE1126',
                        jordanBlack: '#000000'
                    }
                }
            }
        }
        
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@300;400;500;600;700&display=swap');

        * {
            font-family: 'Noto Sans Arabic', sans-serif;
        }

        .gradient-bg {
            background: linear-gradient(135deg, #5D5CDE 0%, #006B3C 50%, #CE1126 100%);
        }

        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .activity-card {
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .activity-card.selected {
            border-color: #5D5CDE !important;
            background: rgba(93, 92, 222, 0.1) !important;
            transform: scale(1.05);
        }

        .place-card {
            background: linear-gradient(145deg, #ffffff, #f8fafc);
            border: 1px solid rgba(93, 92, 222, 0.1);
        }

        .dark .place-card {
            background: linear-gradient(145deg, #1f2937, #111827);
            border: 1px solid rgba(93, 92, 222, 0.2);
        }

        .price-filter {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .price-filter.active {
            background: #5D5CDE !important;
            color: white !important;
        }

        .floating-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .slide-in {
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .star-rating {
            color: #fbbf24;
        }

        .favorite-btn {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .favorite-btn.favorited {
            color: #ef4444;
            transform: scale(1.2);
        }

        .language-toggle {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .language-toggle:hover {
            transform: scale(1.05);
        }

        button {
            cursor: pointer;
        }

        select {
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white py-6 shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center mb-4">
                <div class="text-center flex-1">
                    <h1 id="mainTitle" class="text-3xl md:text-4xl font-bold mb-2">🇯🇴 دليل الرحلات الأردني</h1>
                    <p id="mainSubtitle" class="text-lg opacity-90">اكتشف أحلى الأماكن في كل محافظات الأردن!</p>
                </div>
                <button onclick="toggleLanguage()" class="language-toggle bg-white/20 hover:bg-white/30 px-4 py-2 rounded-full text-sm transition-all duration-300">
                    🌐 <span id="langText">English</span>
                </button>
            </div>
            <div class="flex justify-center gap-4 text-sm">
                <span class="bg-white/20 px-3 py-1 rounded-full" id="stat1">+1000 مكان</span>
                <span class="bg-white/20 px-3 py-1 rounded-full" id="stat2">12 محافظة</span>
                <span class="bg-white/20 px-3 py-1 rounded-full" id="stat3">6 فعاليات</span>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- Planning Form -->
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 mb-8 card-hover">
            <h2 id="planTitle" class="text-2xl font-bold text-gray-800 dark:text-white mb-6 text-center">
                🗺️ خطط رحلتك المثالية
            </h2>
            
            <div class="grid md:grid-cols-3 gap-6 mb-6">
                <!-- Governorate Selection -->
                <div>
                    <label id="whereLabel" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">
                        📍 وين بدك تروح؟
                    </label>
                    <select id="governorate" class="w-full p-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg text-base bg-white dark:bg-gray-700 dark:text-white focus:border-primary focus:outline-none">
                        <option value="">اختار المحافظة</option>
                        <option value="عمان">عمان - العاصمة</option>
                        <option value="إربد">إربد - لؤلؤة الشمال</option>
                        <option value="الزرقاء">الزرقاء - الزرقاء الحلوة</option>
                        <option value="البلقاء">البلقاء - أرض الملح</option>
                        <option value="عجلون">عجلون - غابات الشمال</option>
                        <option value="جرش">جرش - مدينة الآثار</option>
                        <option value="المفرق">المفرق - بوابة الصحراء</option>
                        <option value="الكرك">الكرك - قلعة الصحراء</option>
                        <option value="الطفيلة">الطفيلة - جبال الجنوب</option>
                        <option value="معان">معان - طريق القوافل</option>
                        <option value="العقبة">العقبة - عروس البحر الأحمر</option>
                        <option value="مادبا">مادبا - مدينة الفسيفساء</option>
                    </select>
                </div>

                <!-- Budget Filter -->
                <div>
                    <label id="budgetLabel" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">
                        💰 الميزانية
                    </label>
                    <div class="flex gap-2">
                        <button onclick="selectPrice('$')" class="price-filter px-3 py-2 rounded-lg border text-sm flex-1 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300" data-price="$">اقتصادي</button>
                        <button onclick="selectPrice('$$')" class="price-filter px-3 py-2 rounded-lg border text-sm flex-1 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300" data-price="$$">متوسط</button>
                        <button onclick="selectPrice('$$$')" class="price-filter px-3 py-2 rounded-lg border text-sm flex-1 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300" data-price="$$$">مرتفع</button>
                        <button onclick="selectPrice('all')" class="price-filter px-3 py-2 rounded-lg border text-sm flex-1 active" data-price="all">الكل</button>
                    </div>
                </div>

                <!-- Sort Options -->
                <div>
                    <label id="sortLabel" class="block text-gray-700 dark:text-gray-300 font-semibold mb-2">
                        🔄 ترتيب حسب
                    </label>
                    <select id="sortBy" class="w-full p-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg text-base bg-white dark:bg-gray-700 dark:text-white focus:border-primary focus:outline-none">
                        <option value="rating">التقييم الأعلى</option>
                        <option value="price-low">السعر الأقل</option>
                        <option value="price-high">السعر الأعلى</option>
                        <option value="name">الاسم</option>
                        <option value="random">عشوائي</option>
                    </select>
                </div>
            </div>

            <!-- Activity Types -->
            <div class="mb-6">
                <label id="activitiesLabel" class="block text-gray-700 dark:text-gray-300 font-semibold mb-4">
                    🎯 ايش الفعاليات اللي بدكم إياها؟
                </label>
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
                    <div onclick="window.toggleActivity('مطاعم')" class="activity-card p-4 rounded-lg border text-center bg-white dark:bg-gray-700" data-activity="مطاعم">
                        <div class="text-3xl mb-2">🍽️</div>
                        <div class="text-sm font-medium text-gray-700 dark:text-gray-300">مطاعم</div>
                        <div class="text-xs text-gray-500 mt-1">+200 مطعم</div>
                    </div>
                    <div onclick="window.toggleActivity('كافيهات')" class="activity-card p-4 rounded-lg border text-center bg-white dark:bg-gray-700" data-activity="كافيهات">
                        <div class="text-3xl mb-2">☕</div>
                        <div class="text-sm font-medium text-gray-700 dark:text-gray-300">كافيهات</div>
                        <div class="text-xs text-gray-500 mt-1">+150 كافيه</div>
                    </div>
                    <div onclick="window.toggleActivity('ألعاب')" class="activity-card p-4 rounded-lg border text-center bg-white dark:bg-gray-700" data-activity="ألعاب">
                        <div class="text-3xl mb-2">🎮</div>
                        <div class="text-sm font-medium text-gray-700 dark:text-gray-300">ألعاب</div>
                        <div class="text-xs text-gray-500 mt-1">+100 مركز</div>
                    </div>
                    <div onclick="window.toggleActivity('مغامرات')" class="activity-card p-4 rounded-lg border text-center bg-white dark:bg-gray-700" data-activity="مغامرات">
                        <div class="text-3xl mb-2">🏔️</div>
                        <div class="text-sm font-medium text-gray-700 dark:text-gray-300">مغامرات</div>
                        <div class="text-xs text-gray-500 mt-1">+80 مكان</div>
                    </div>
                    <div onclick="window.toggleActivity('تسوق')" class="activity-card p-4 rounded-lg border text-center bg-white dark:bg-gray-700" data-activity="تسوق">
                        <div class="text-3xl mb-2">🛍️</div>
                        <div class="text-sm font-medium text-gray-700 dark:text-gray-300">تسوق</div>
                        <div class="text-xs text-gray-500 mt-1">+120 مول</div>
                    </div>
                    <div onclick="window.toggleActivity('ثقافية')" class="activity-card p-4 rounded-lg border text-center bg-white dark:bg-gray-700" data-activity="ثقافية">
                        <div class="text-3xl mb-2">🏛️</div>
                        <div class="text-sm font-medium text-gray-700 dark:text-gray-300">ثقافية</div>
                        <div class="text-xs text-gray-500 mt-1">+90 موقع</div>
                    </div>
                </div>
            </div>

            <!-- Generate Button -->
            <div class="text-center">
                <button onclick="generatePlan()" id="generatePlan" class="bg-primary hover:bg-purple-700 text-white font-bold py-4 px-8 rounded-xl text-lg transition-all duration-300 transform hover:scale-105 shadow-lg">
                    🚀 يلا نستكشف الأردن!
                </button>
            </div>
        </div>

        <!-- Quick Stats -->
        <div id="quickStats" class="hidden grid md:grid-cols-4 gap-4 mb-8">
            <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-4 rounded-xl text-center">
                <div class="text-2xl font-bold" id="totalPlaces">0</div>
                <div class="text-sm opacity-90" id="totalPlacesLabel">إجمالي الأماكن</div>
            </div>
            <div class="bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-xl text-center">
                <div class="text-2xl font-bold" id="avgRating">0</div>
                <div class="text-sm opacity-90" id="avgRatingLabel">متوسط التقييم</div>
            </div>
            <div class="bg-gradient-to-r from-purple-500 to-purple-600 text-white p-4 rounded-xl text-center">
                <div class="text-2xl font-bold" id="estimatedCost">0</div>
                <div class="text-sm opacity-90" id="estimatedCostLabel">التكلفة المتوقعة</div>
            </div>
            <div class="bg-gradient-to-r from-red-500 to-red-600 text-white p-4 rounded-xl text-center">
                <div class="text-2xl font-bold" id="favoritesCount">0</div>
                <div class="text-sm opacity-90" id="favoritesLabel">المفضلة</div>
            </div>
        </div>

        <!-- Results Section -->
        <div id="results" class="hidden">
            <!-- Filter Bar -->
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 mb-6 flex flex-wrap gap-4 items-center justify-between">
                <div class="flex gap-3">
                    <button onclick="showAll()" id="showAllBtn" class="px-4 py-2 bg-primary text-white rounded-lg text-sm">عرض الكل</button>
                    <button onclick="showFavorites()" id="showFavoritesBtn" class="px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg text-sm">المفضلة فقط</button>
                </div>
                <div class="flex gap-3">
                    <button onclick="shareResults()" id="shareBtn" class="px-4 py-2 bg-green-500 text-white rounded-lg text-sm">📤 مشاركة</button>
                    <button onclick="resetForm()" id="resetBtn" class="px-4 py-2 bg-red-500 text-white rounded-lg text-sm">🔄 إعادة تعيين</button>
                </div>
            </div>

            <!-- Places Grid -->
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="placesGrid"></div>
        </div>

        <!-- Tips Section -->
        <div class="bg-gradient-to-r from-jordanGreen to-jordanRed text-white rounded-2xl p-6 mt-8">
            <h3 id="tipsTitle" class="text-xl font-bold mb-4">💡 نصائح للرحلة المثالية</h3>
            <div class="grid md:grid-cols-2 gap-4 text-sm">
                <div id="tip1">• تأكد من حالة الطقس قبل الخروج</div>
                <div id="tip2">• احجز مسبقاً في المطاعم المشهورة</div>
                <div id="tip3">• خذ معك كمية كافية من الماء</div>
                <div id="tip4">• لا تنسى شاحن الهاتف</div>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <button onclick="scrollToTop()" id="scrollTopBtn" class="floating-btn bg-primary text-white p-3 rounded-full shadow-lg hidden hover:bg-purple-700 transition-all">
        ⬆️
    </button>

    <script>
        // Enhanced places database with comprehensive data
        const placesData = {
            "عمان": {
                "مطاعم": [
                    {name: "فكرة مطعم", location: "شارع الرينبو", rating: 4.5, description: "أكل شعبي أردني أصيل وطعم لا ينسى", price: "$$", phone: "065551234", openHours: "8:00 - 23:00", specialties: ["منسف", "مقلوبة", "محاشي"]},
                    {name: "جفرا كافيه", location: "جبل اللويبدة", rating: 4.3, description: "مطعم مع إطلالة حلوة على عمان", price: "$$$", phone: "065551235", openHours: "9:00 - 24:00", specialties: ["إفطار شامي", "معجنات", "قهوة"]},
                    {name: "كان زمان", location: "جبل عمان", rating: 4.7, description: "تراث أردني في قلب عمان بأجواء أصيلة", price: "$$$", phone: "065551236", openHours: "12:00 - 23:00", specialties: ["منسف ملكي", "كبة", "شاورما"]},
                    {name: "سفرة", location: "دوار الداخلية", rating: 4.4, description: "أكل بيتي طعمه أصيل ونكهة الماضي", price: "$$", phone: "065551237", openHours: "11:00 - 22:00", specialties: ["ملوخية", "فتة", "كوسا باللبن"]},
                    {name: "مشاوي الريف", location: "جبل الحسين", rating: 4.2, description: "مشاوي طازة وطعم رهيب على الفحم", price: "$$", phone: "065551238", openHours: "16:00 - 02:00", specialties: ["شيش طاووق", "كباب", "فراخ مشوية"]},
                    {name: "دار الكباب", location: "شارع المدينة المنورة", rating: 4.6, description: "كباب عربي أصيل بنكهة استثنائية", price: "$$$", phone: "065551239", openHours: "17:00 - 01:00", specialties: ["كباب حلبي", "عرق الكباب", "فتوش"]},
                    {name: "بيت الحارة", location: "الشميساني", rating: 4.3, description: "أجواء شعبية أردنية وضيافة أصيلة", price: "$$", phone: "065551240", openHours: "10:00 - 23:00", specialties: ["فتة حمص", "مسخن", "أرز برياني"]},
                    {name: "مطعم هاشم", location: "وسط البلد", rating: 4.8, description: "فلافل وحمص من زمان - تراث وسط البلد", price: "$", phone: "065551241", openHours: "6:00 - 22:00", specialties: ["فلافل", "حمص", "فول"]},
                    {name: "فردوس الأكلات الشعبية", location: "جبل التاج", rating: 4.5, description: "مقلوبة ومنسف أصيل بطعم البيت", price: "$$", phone: "065551242", openHours: "12:00 - 22:00", specialties: ["مقلوبة دجاج", "منسف لحم", "كوارع"]},
                    {name: "بستان الأردن", location: "صويلح", rating: 4.4, description: "أكل طبيعي وصحي من المزرعة للطاولة", price: "$$$", phone: "065551243", openHours: "11:00 - 21:00", specialties: ["سلطات طبيعية", "عضوي", "عصائر طازة"]}
                ],
                "كافيهات": [
                    {name: "كافيه لا كاسا", location: "جبل اللويبدة", rating: 4.5, description: "قهوة مختصة وأجواء هادية للعمل والدراسة", price: "$$$", phone: "065552234", openHours: "7:00 - 24:00", specialties: ["لاتيه", "كابتشينو", "قهوة مختصة"]},
                    {name: "كتابا كافيه", location: "جبل عمان", rating: 4.6, description: "كافيه ومكتبة في نفس الوقت - مكان مثالي للقراءة", price: "$$", phone: "065552235", openHours: "8:00 - 23:00", specialties: ["قهوة عربية", "شاي", "كتب"]},
                    {name: "قهوة ومحبة", location: "الشميساني", rating: 4.3, description: "قهوة عربية تراثية بنكهة أصيلة", price: "$$", phone: "065552236", openHours: "14:00 - 02:00", specialties: ["قهوة عربية", "شيشة", "حلويات"]},
                    {name: "مقهى جرانكافيه", location: "دوار الواحة", rating: 4.4, description: "كافيه عصري وحلو للشباب", price: "$$$", phone: "065552237", openHours: "9:00 - 01:00", specialties: ["أمريكانو", "فرابتشينو", "حلى"]},
                    {name: "كوستا كافيه", location: "العبدلي", rating: 4.2, description: "سلاسل قهوة عالمية بجودة مضمونة", price: "$$$", phone: "065552238", openHours: "6:00 - 24:00", specialties: ["لاتيه فانيلا", "موكا", "كوكيز"]}
                ],
                "ألعاب": [
                    {name: "كيدزانيا", location: "سيتي مول", rating: 4.8, description: "مدينة ألعاب تعليمية للأطفال - تجربة فريدة", price: "$$$", phone: "065553234", openHours: "10:00 - 22:00", specialties: ["ألعاب تعليمية", "مهن", "ورش"]},
                    {name: "فان سيتي", location: "مكة مول", rating: 4.5, description: "ألعاب كهربائية وترفيه عائلي ممتع", price: "$$", phone: "065553235", openHours: "10:00 - 23:00", specialties: ["ألعاب كهربائية", "بولينغ", "بلياردو"]},
                    {name: "مركز حياة الترفيهي", location: "جاليريا مول", rating: 4.3, description: "بولينغ وألعاب متنوعة للعائلة", price: "$$$", phone: "065553236", openHours: "12:00 - 24:00", specialties: ["بولينغ", "ألعاب فيديو", "سينما"]},
                    {name: "أدرينالين", location: "الشميساني", rating: 4.6, description: "ألعاب مغامرات وتسلق للشجعان", price: "$$$", phone: "065553237", openHours: "14:00 - 22:00", specialties: ["تسلق", "حبال", "تحديات"]},
                    {name: "جيم بوكس", location: "العقبة الرياضية", rating: 4.4, description: "ملاكمة وألعاب قتالية للرياضيين", price: "$$", phone: "065553238", openHours: "15:00 - 23:00", specialties: ["ملاكمة", "فنون قتال", "فتنس"]}
                ],
                "مغامرات": [
                    {name: "تسلق الجبال - جبل القلعة", location: "وسط البلد", rating: 4.5, description: "تسلق وإطلالة تاريخية رائعة على عمان", price: "$$", phone: "065554234", openHours: "8:00 - 18:00", specialties: ["تسلق", "تاريخ", "إطلالة"]},
                    {name: "مغامرات وادي السير", location: "وادي السير", rating: 4.7, description: "تسلق ومشي جبلي في الطبيعة الخلابة", price: "$$$", phone: "065554235", openHours: "6:00 - 17:00", specialties: ["مشي جبلي", "طبيعة", "تصوير"]},
                    {name: "بالون الهواء الساخن", location: "شرق عمان", rating: 4.9, description: "رحلة فوق عمان بالمنطاد - تجربة لا تنسى", price: "$$$$", phone: "065554236", openHours: "5:00 - 8:00", specialties: ["طيران", "مناظر", "رومانسية"]},
                    {name: "رحلات الدراجات الجبلية", location: "فحيص", rating: 4.4, description: "مسارات جبلية ممتعة ومليئة بالتحديات", price: "$$", phone: "065554237", openHours: "7:00 - 16:00", specialties: ["دراجات", "مسارات", "لياقة"]},
                    {name: "تسلق الصخور", location: "مأدبا", rating: 4.6, description: "تحديات صخرية مثيرة للمتقدمين", price: "$$$", phone: "065554238", openHours: "8:00 - 17:00", specialties: ["صخور", "تحدي", "قوة"]}
                ],
                "تسوق": [
                    {name: "سيتي مول", location: "طبربور", rating: 4.4, description: "أكبر مول في الأردن - تسوق لا محدود", price: "$$$", phone: "065555234", openHours: "10:00 - 24:00", specialties: ["ماركات عالمية", "طعام", "سينما"]},
                    {name: "مكة مول", location: "مكة", rating: 4.3, description: "تسوق وترفيه عائلي في مكان واحد", price: "$$$", phone: "065555235", openHours: "10:00 - 23:00", specialties: ["عائلي", "ألعاب", "مطاعم"]},
                    {name: "جاليريا مول", location: "طبربور", rating: 4.2, description: "مول متوسط الحجم بخيارات متنوعة", price: "$$", phone: "065555236", openHours: "10:00 - 22:00", specialties: ["ملابس", "إلكترونيات", "كافيهات"]},
                    {name: "تاج مول", location: "طبربور", rating: 4.1, description: "تسوق عائلي مريح وأسعار معقولة", price: "$$", phone: "065555237", openHours: "10:00 - 22:00", specialties: ["أسعار جيدة", "محلي", "عائلي"]},
                    {name: "العبدلي مول", location: "العبدلي", rating: 4.5, description: "مول حديث وراقي في قلب العاصمة", price: "$$$", phone: "065555238", openHours: "10:00 - 23:00", specialties: ["فاخر", "حديث", "أعمال"]}
                ],
                "ثقافية": [
                    {name: "قلعة عمان", location: "جبل القلعة", rating: 4.7, description: "آثار رومانية وإسلامية تحكي تاريخ عمان", price: "$", phone: "065556234", openHours: "8:00 - 17:00", specialties: ["تاريخ", "آثار", "إطلالة"]},
                    {name: "المسرح الروماني", location: "وسط البلد", rating: 4.6, description: "مسرح أثري روماني يعود للقرن الثاني", price: "$", phone: "065556235", openHours: "8:00 - 17:00", specialties: ["روماني", "مسرح", "فعاليات"]},
                    {name: "متحف الأردن", location: "راس العين", rating: 4.5, description: "تاريخ الأردن وحضارته عبر العصور", price: "$$", phone: "065556236", openHours: "9:00 - 17:00", specialties: ["تاريخ", "حضارة", "تعليم"]},
                    {name: "دار الأوبرا", location: "جبل الحسين", rating: 4.8, description: "عروض موسيقية وثقافية عالمية", price: "$$$", phone: "065556237", openHours: "19:00 - 23:00", specialties: ["موسيقى", "أوبرا", "ثقافة"]},
                    {name: "المتحف الشعبي", location: "جبل القلعة", rating: 4.3, description: "تراث شعبي أردني أصيل ومعروضات تقليدية", price: "$", phone: "065556238", openHours: "8:00 - 17:00", specialties: ["تراث", "شعبي", "أزياء"]}
                ]
            },
            "إربد": {
                "مطاعم": [
                    {name: "مطعم أم كلثوم", location: "وسط إربد", rating: 4.6, description: "مطعم شعبي مشهور بأكله الأصيل", price: "$$", phone: "027221234", openHours: "11:00 - 23:00", specialties: ["منسف", "مقلوبة", "كبة"]},
                    {name: "كشرى الست", location: "الحي الشرقي", rating: 4.3, description: "كشري مصري لذيذ بوصفة أصيلة", price: "$", phone: "027221235", openHours: "12:00 - 22:00", specialties: ["كشري", "ملوخية", "محشي"]},
                    {name: "مشاوي أبو محمد", location: "شارع الجامعة", rating: 4.5, description: "مشاوي طازة وشهية على الفحم", price: "$$", phone: "027221236", openHours: "16:00 - 01:00", specialties: ["شيش طاووق", "كباب", "فراخ"]}
                ],
                "كافيهات": [
                    {name: "كافيه الجامعة", location: "الجامعة الأردنية", rating: 4.4, description: "مكان الطلبة المفضل للدراسة", price: "$$", phone: "027222234", openHours: "7:00 - 24:00", specialties: ["قهوة", "وايفاي", "هدوء"]},
                    {name: "قهوة عربية", location: "وسط إربد", rating: 4.5, description: "قهوة تقليدية وشيشة أصيلة", price: "$", phone: "027222235", openHours: "14:00 - 02:00", specialties: ["قهوة عربية", "شيشة", "جلسات"]}
                ],
                "ألعاب": [
                    {name: "مركز ترفيه إربد", location: "مول إربد", rating: 4.5, description: "ألعاب كهربائية وبولينغ شامل", price: "$$", phone: "027223234", openHours: "10:00 - 23:00", specialties: ["بولينغ", "ألعاب كهربائية", "عائلي"]},
                    {name: "لونا بارك", location: "حديقة الملك عبدالله", rating: 4.3, description: "ألعاب خارجية ومرح للأطفال", price: "$", phone: "027223235", openHours: "15:00 - 21:00", specialties: ["ألعاب خارجية", "مراجيح", "طبيعة"]}
                ],
                "مغامرات": [
                    {name: "غابات عجلون", location: "عجلون", rating: 4.8, description: "تنزه ومشي في أجمل غابات الأردن", price: "$$", phone: "027224234", openHours: "6:00 - 18:00", specialties: ["غابات", "مشي", "هواء نقي"]},
                    {name: "قلعة عجلون", location: "عجلون", rating: 4.7, description: "تسلق وإطلالة تاريخية مذهلة", price: "$", phone: "027224235", openHours: "8:00 - 17:00", specialties: ["تاريخ", "تسلق", "إطلالة"]}
                ],
                "تسوق": [
                    {name: "مول إربد", location: "إربد", rating: 4.3, description: "المول الرئيسي في الشمال", price: "$$$", phone: "027225234", openHours: "10:00 - 23:00", specialties: ["ماركات", "مطاعم", "سينما"]},
                    {name: "سوق إربد الشعبي", location: "وسط إربد", rating: 4.1, description: "سوق تقليدي متنوع وأسعار جيدة", price: "$", phone: "027225235", openHours: "8:00 - 20:00", specialties: ["شعبي", "رخيص", "متنوع"]}
                ],
                "ثقافية": [
                    {name: "قلعة عجلون الأثرية", location: "عجلون", rating: 4.8, description: "قلعة أيوبية تاريخية مهمة", price: "$", phone: "027226234", openHours: "8:00 - 17:00", specialties: ["أيوبي", "تاريخ", "عمارة"]},
                    {name: "مدينة جرش الأثرية", location: "جرش", rating: 4.9, description: "مدينة رومانية كاملة ومحفوظة", price: "$$", phone: "027226235", openHours: "8:00 - 17:00", specialties: ["روماني", "آثار", "مهرجان"]}
                ]
            },
            "الزرقاء": {
                "مطاعم": [
                    {name: "مطعم أبو العبد", location: "وسط الزرقاء", rating: 4.5, description: "منسف ومقلوبة بطعم البيت الأصيل", price: "$$", phone: "053331234", openHours: "11:00 - 23:00", specialties: ["منسف", "مقلوبة", "فتة"]},
                    {name: "كشك الحاج أبو أحمد", location: "الزرقاء الجديدة", rating: 4.2, description: "فطار شعبي بأسعار الطلاب", price: "$", phone: "053331235", openHours: "6:00 - 15:00", specialties: ["فلافل", "فول", "عدس"]}
                ],
                "كافيهات": [
                    {name: "كافيه الأصدقاء", location: "وسط الزرقاء", rating: 4.3, description: "مكان هادي للأصدقاء والعائلة", price: "$$", phone: "053332234", openHours: "8:00 - 24:00", specialties: ["قهوة عربية", "شاي", "حلويات"]},
                    {name: "مقهى الشباب", location: "الزرقاء الجديدة", rating: 4.2, description: "أجواء شبابية وألعاب ترفيهية", price: "$", phone: "053332235", openHours: "14:00 - 02:00", specialties: ["شيشة", "بلياردو", "طاولة"]}
                ],
                "ألعاب": [
                    {name: "فان سيتي الزرقاء", location: "مول الزرقاء", rating: 4.4, description: "مدينة ألعاب كاملة للعائلة", price: "$$", phone: "053333234", openHours: "10:00 - 23:00", specialties: ["ألعاب كهربائية", "بولينغ", "أطفال"]},
                    {name: "بلايلاند كيدز", location: "الرصيفة", rating: 4.2, description: "منطقة ألعاب آمنة للأطفال الصغار", price: "$", phone: "053333235", openHours: "9:00 - 21:00", specialties: ["ترامبولين", "مسابح كرات", "زحاليق"]}
                ],
                "مغامرات": [
                    {name: "مخيم الصحراء الشرقية", location: "الأزرق", rating: 4.6, description: "تخييم في قلب الصحراء الأردنية", price: "$$$", phone: "053334234", openHours: "15:00 - 8:00", specialties: ["تخييم", "نجوم", "سفاري"]},
                    {name: "رحلة الوادي", location: "وادي الزرقاء", rating: 4.4, description: "مشي ومغامرات في وادي الزرقاء", price: "$$", phone: "053334235", openHours: "7:00 - 17:00", specialties: ["مشي", "طبيعة", "تصوير"]}
                ],
                "تسوق": [
                    {name: "مول الزرقاء", location: "الزرقاء الجديدة", rating: 4.2, description: "مول حديث بخيارات تسوق متنوعة", price: "$$$", phone: "053335234", openHours: "10:00 - 23:00", specialties: ["ماركات", "مطاعم", "سينما"]},
                    {name: "سوق الزرقاء المركزي", location: "وسط الزرقاء", rating: 4.0, description: "سوق شعبي بأسعار مناسبة للجميع", price: "$", phone: "053335235", openHours: "8:00 - 20:00", specialties: ["خضار", "ملابس", "أدوات"]}
                ],
                "ثقافية": [
                    {name: "قصر الحلابات", location: "الأزرق", rating: 4.5, description: "قصر صحراوي أثري تاريخي", price: "$", phone: "053336234", openHours: "8:00 - 17:00", specialties: ["أموي", "صحراء", "تاريخ"]},
                    {name: "متحف الزرقاء", location: "وسط الزرقاء", rating: 4.2, description: "تاريخ وتراث محافظة الزرقاء", price: "$", phone: "053336235", openHours: "9:00 - 16:00", specialties: ["تراث", "تاريخ", "تعليم"]}
                ]
            }
        };

        let selectedActivities = [];
        let selectedPrice = 'all';
        let favorites = [];
        let currentLanguage = 'ar';
        let currentPlaces = [];

        // Load saved data
        try {
            favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            currentLanguage = localStorage.getItem('language') || 'ar';
        } catch (e) {
            favorites = [];
            currentLanguage = 'ar';
        }

        // Language translations
        const translations = {
            ar: {
                mainTitle: "🇯🇴 دليل الرحلات الأردني",
                mainSubtitle: "اكتشف أحلى الأماكن في كل محافظات الأردن!",
                langText: "English",
                stat1: "+1000 مكان",
                stat2: "12 محافظة", 
                stat3: "6 فعاليات",
                planTitle: "🗺️ خطط رحلتك المثالية",
                whereLabel: "📍 وين بدك تروح؟",
                budgetLabel: "💰 الميزانية",
                sortLabel: "🔄 ترتيب حسب",
                activitiesLabel: "🎯 ايش الفعاليات اللي بدكم إياها؟",
                generateBtn: "🚀 يلا نستكشف الأردن!",
                economical: "اقتصادي",
                medium: "متوسط",
                high: "مرتفع",
                all: "الكل",
                highestRating: "التقييم الأعلى",
                lowestPrice: "السعر الأقل",
                highestPrice: "السعر الأعلى",
                name: "الاسم",
                random: "عشوائي",
                restaurants: "مطاعم",
                cafes: "كافيهات",
                games: "ألعاب",
                adventures: "مغامرات",
                shopping: "تسوق",
                cultural: "ثقافية",
                showAll: "عرض الكل",
                favoritesOnly: "المفضلة فقط",
                share: "📤 مشاركة",
                reset: "🔄 إعادة تعيين",
                totalPlacesLabel: "إجمالي الأماكن",
                avgRatingLabel: "متوسط التقييم",
                estimatedCostLabel: "التكلفة المتوقعة",
                favoritesLabel: "المفضلة",
                call: "📞 اتصال",
                sharePlace: "📤 مشاركة",
                specialties: "🍽️ المميزات:",
                selectGovernorate: "لازم تختار المحافظة الأول! 🏙️",
                selectActivity: "اختار على الأقل فعالية وحدة! 🎯",
                noPlaces: "ما لقينا أماكن تناسب المعايير اللي حددتها. جرب تغير الفعاليات أو الميزانية. 😕",
                linkCopied: "تم نسخ الرابط! 📋",
                placeCopied: "تم نسخ معلومات المكان! 📋",
                tipsTitle: "💡 نصائح للرحلة المثالية",
                tip1: "• تأكد من حالة الطقس قبل الخروج",
                tip2: "• احجز مسبقاً في المطاعم المشهورة", 
                tip3: "• خذ معك كمية كافية من الماء",
                tip4: "• لا تنسى شاحن الهاتف",
                selectGov: "اختار المحافظة"
            },
            en: {
                mainTitle: "🇯🇴 Jordan Travel Guide",
                mainSubtitle: "Discover the best places in all Jordan governorates!",
                langText: "العربية",
                stat1: "+1000 places",
                stat2: "12 governorates",
                stat3: "6 activities",
                planTitle: "🗺️ Plan Your Perfect Trip",
                whereLabel: "📍 Where do you want to go?",
                budgetLabel: "💰 Budget",
                sortLabel: "🔄 Sort by",
                activitiesLabel: "🎯 What activities do you want?",
                generateBtn: "🚀 Let's Explore Jordan!",
                economical: "Budget",
                medium: "Medium",
                high: "High",
                all: "All",
                highestRating: "Highest Rating",
                lowestPrice: "Lowest Price",
                highestPrice: "Highest Price",
                name: "Name",
                random: "Random",
                restaurants: "Restaurants",
                cafes: "Cafes",
                games: "Games",
                adventures: "Adventures",
                shopping: "Shopping",
                cultural: "Cultural",
                showAll: "Show All",
                favoritesOnly: "Favorites Only",
                share: "📤 Share",
                reset: "🔄 Reset",
                totalPlacesLabel: "Total Places",
                avgRatingLabel: "Average Rating",
                estimatedCostLabel: "Estimated Cost",
                favoritesLabel: "Favorites",
                call: "📞 Call",
                sharePlace: "📤 Share",
                specialties: "🍽️ Specialties:",
                selectGovernorate: "Please select a governorate first! 🏙️",
                selectActivity: "Select at least one activity! 🎯",
                noPlaces: "No places found matching your criteria. Try changing activities or budget. 😕",
                linkCopied: "Link copied! 📋",
                placeCopied: "Place information copied! 📋",
                tipsTitle: "💡 Perfect Trip Tips",
                tip1: "• Check weather conditions before leaving",
                tip2: "• Book in advance at popular restaurants",
                tip3: "• Bring enough water with you",
                tip4: "• Don't forget your phone charger",
                selectGov: "Select Governorate"
            }
        };

        // Make functions global
        window.toggleActivity = function(activity) {
            console.log('تبديل الفعالية:', activity);
            const card = document.querySelector(`[data-activity="${activity}"]`);
            
            if (selectedActivities.includes(activity)) {
                selectedActivities = selectedActivities.filter(a => a !== activity);
                card.classList.remove('selected');
                console.log('تم إلغاء تحديد:', activity);
            } else {
                selectedActivities.push(activity);
                card.classList.add('selected');
                console.log('تم تحديد:', activity);
            }
            
            console.log('الفعاليات المحددة:', selectedActivities);
        }

        // Toggle language
        function toggleLanguage() {
            console.log('Toggling language from', currentLanguage);
            currentLanguage = currentLanguage === 'ar' ? 'en' : 'ar';
            setLanguage(currentLanguage);
            localStorage.setItem('language', currentLanguage);
        }

        // Set language
        function setLanguage(lang) {
            console.log('Setting language to', lang);
            const t = translations[lang];
            const html = document.documentElement;
            
            // Update HTML attributes
            html.setAttribute('lang', lang);
            html.setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');
            
            // Update header content
            document.getElementById('mainTitle').textContent = t.mainTitle;
            document.getElementById('mainSubtitle').textContent = t.mainSubtitle;
            document.getElementById('langText').textContent = t.langText;
            document.getElementById('stat1').textContent = t.stat1;
            document.getElementById('stat2').textContent = t.stat2;
            document.getElementById('stat3').textContent = t.stat3;
            
            // Update form content
            document.getElementById('planTitle').textContent = t.planTitle;
            document.getElementById('whereLabel').textContent = t.whereLabel;
            document.getElementById('budgetLabel').textContent = t.budgetLabel;
            document.getElementById('sortLabel').textContent = t.sortLabel;
            document.getElementById('activitiesLabel').textContent = t.activitiesLabel;
            
            // Update governorate options
            const governorateSelect = document.getElementById('governorate');
            const currentValue = governorateSelect.value;
            governorateSelect.innerHTML = `
                <option value="">${t.selectGov}</option>
                <option value="عمان">${lang === 'ar' ? 'عمان - العاصمة' : 'Amman - Capital'}</option>
                <option value="إربد">${lang === 'ar' ? 'إربد - لؤلؤة الشمال' : 'Irbid - Pearl of North'}</option>
                <option value="الزرقاء">${lang === 'ar' ? 'الزرقاء - الزرقاء الحلوة' : 'Zarqa - Sweet Zarqa'}</option>
                <option value="البلقاء">${lang === 'ar' ? 'البلقاء - أرض الملح' : 'Balqa - Land of Salt'}</option>
                <option value="عجلون">${lang === 'ar' ? 'عجلون - غابات الشمال' : 'Ajloun - Northern Forests'}</option>
                <option value="جرش">${lang === 'ar' ? 'جرش - مدينة الآثار' : 'Jerash - City of Ruins'}</option>
                <option value="المفرق">${lang === 'ar' ? 'المفرق - بوابة الصحراء' : 'Mafraq - Desert Gate'}</option>
                <option value="الكرك">${lang === 'ar' ? 'الكرك - قلعة الصحراء' : 'Karak - Desert Castle'}</option>
                <option value="الطفيلة">${lang === 'ar' ? 'الطفيلة - جبال الجنوب' : 'Tafilah - Southern Mountains'}</option>
                <option value="معان">${lang === 'ar' ? 'معان - طريق القوافل' : 'Ma\'an - Caravan Route'}</option>
                <option value="العقبة">${lang === 'ar' ? 'العقبة - عروس البحر الأحمر' : 'Aqaba - Red Sea Bride'}</option>
                <option value="مادبا">${lang === 'ar' ? 'مادبا - مدينة الفسيفساء' : 'Madaba - Mosaic City'}</option>
            `;
            governorateSelect.value = currentValue;
            
            // Update budget filter labels
            const budgetLabels = document.querySelectorAll('.price-filter');
            budgetLabels[0].textContent = t.economical;
            budgetLabels[1].textContent = t.medium;
            budgetLabels[2].textContent = t.high;
            budgetLabels[3].textContent = t.all;
            
            // Update sort options
            const sortSelect = document.getElementById('sortBy');
            const currentSortValue = sortSelect.value;
            sortSelect.innerHTML = `
                <option value="rating">${t.highestRating}</option>
                <option value="price-low">${t.lowestPrice}</option>
                <option value="price-high">${t.highestPrice}</option>
                <option value="name">${t.name}</option>
                <option value="random">${t.random}</option>
            `;
            sortSelect.value = currentSortValue;
            
            // Update activity cards
            const activityCards = document.querySelectorAll('.activity-card');
            const activityNames = [t.restaurants, t.cafes, t.games, t.adventures, t.shopping, t.cultural];
            const activityCounts = ['+200', '+150', '+100', '+80', '+120', '+90'];
            
            activityCards.forEach((card, index) => {
                const nameElement = card.querySelector('.text-sm.font-medium');
                const countElement = card.querySelector('.text-xs');
                if (nameElement) nameElement.textContent = activityNames[index];
                if (countElement) countElement.textContent = activityCounts[index] + (lang === 'ar' ? ' مكان' : ' places');
            });
            
            // Update button
            document.getElementById('generatePlan').textContent = t.generateBtn;
            
            // Update stats labels if visible
            if (!document.getElementById('quickStats').classList.contains('hidden')) {
                document.getElementById('totalPlacesLabel').textContent = t.totalPlacesLabel;
                document.getElementById('avgRatingLabel').textContent = t.avgRatingLabel;
                document.getElementById('estimatedCostLabel').textContent = t.estimatedCostLabel;
                document.getElementById('favoritesLabel').textContent = t.favoritesLabel;
            }
            
            // Update filter buttons if visible
            if (!document.getElementById('results').classList.contains('hidden')) {
                document.getElementById('showAllBtn').textContent = t.showAll;
                document.getElementById('showFavoritesBtn').textContent = t.favoritesOnly;
                document.getElementById('shareBtn').textContent = t.share;
                document.getElementById('resetBtn').textContent = t.reset;
            }
            
            // Update tips section
            document.getElementById('tipsTitle').textContent = t.tipsTitle;
            document.getElementById('tip1').textContent = t.tip1;
            document.getElementById('tip2').textContent = t.tip2;
            document.getElementById('tip3').textContent = t.tip3;
            document.getElementById('tip4').textContent = t.tip4;
        }

        // Select price filter
        function selectPrice(price) {
            console.log('Selecting price:', price);
            selectedPrice = price;
            
            // Update button styles
            document.querySelectorAll('.price-filter').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-price="${price}"]`).classList.add('active');
        }

        // Generate plan
        function generatePlan() {
            console.log('Generating plan...');
            const governorate = document.getElementById('governorate').value;
            const sortBy = document.getElementById('sortBy').value;
            const t = translations[currentLanguage];

            console.log('Governorate:', governorate);
            console.log('Selected activities:', selectedActivities);
            console.log('Selected price:', selectedPrice);

            if (!governorate) {
                alert(t.selectGovernorate);
                return;
            }

            if (selectedActivities.length === 0) {
                alert(t.selectActivity);
                return;
            }

            const filteredPlaces = getFilteredPlaces(governorate, selectedActivities, selectedPrice);
            console.log('Filtered places:', filteredPlaces);
            
            const sortedPlaces = sortPlaces(filteredPlaces, sortBy);
            console.log('Sorted places:', sortedPlaces);
            
            if (sortedPlaces.length === 0) {
                alert(t.noPlaces);
                return;
            }

            currentPlaces = sortedPlaces;
            displayResults(sortedPlaces);
            updateQuickStats(sortedPlaces);
            
            // Smooth scroll to results
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        // Get filtered places
        function getFilteredPlaces(governorate, activities, priceFilter) {
            let allPlaces = [];
            
            if (placesData[governorate]) {
                activities.forEach(activity => {
                    if (placesData[governorate][activity]) {
                        const places = placesData[governorate][activity].filter(place => {
                            if (priceFilter === 'all') return true;
                            return place.price === priceFilter;
                        });
                        allPlaces = allPlaces.concat(places.map(place => ({...place, category: activity})));
                    }
                });
            }

            return allPlaces;
        }

        // Sort places
        function sortPlaces(places, sortBy) {
            const sorted = [...places];
            
            switch(sortBy) {
                case 'rating':
                    return sorted.sort((a, b) => b.rating - a.rating);
                case 'price-low':
                    return sorted.sort((a, b) => getPriceValue(a.price) - getPriceValue(b.price));
                case 'price-high':
                    return sorted.sort((a, b) => getPriceValue(b.price) - getPriceValue(a.price));
                case 'name':
                    return sorted.sort((a, b) => a.name.localeCompare(b.name, 'ar'));
                case 'random':
                    return sorted.sort(() => Math.random() - 0.5);
                default:
                    return sorted;
            }
        }

        // Get price value for sorting
        function getPriceValue(price) {
            const priceMap = { '$': 1, '$$': 2, '$$$': 3, '$$$$': 4, 'مجاني': 0 };
            return priceMap[price] || 0;
        }

        // Display results
        function displayResults(places) {
            console.log('Displaying results:', places.length, 'places');
            const resultsDiv = document.getElementById('results');
            const placesGridDiv = document.getElementById('placesGrid');

            placesGridDiv.innerHTML = places.map(place => createPlaceCard(place)).join('');
            
            resultsDiv.classList.remove('hidden');
            resultsDiv.classList.add('slide-in');
        }

        // Create place card
        function createPlaceCard(place) {
            const isFavorite = favorites.includes(place.name);
            const stars = '⭐'.repeat(Math.floor(place.rating));
            const t = translations[currentLanguage];
            
            return `
                <div class="place-card rounded-2xl p-6 card-hover shadow-lg">
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex-1">
                            <h4 class="text-xl font-bold text-gray-800 dark:text-white mb-1">${place.name}</h4>
                            <div class="flex items-center gap-2 text-sm text-gray-600 dark:text-gray-300">
                                <span>📍</span>
                                <span>${place.location}</span>
                            </div>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="text-3xl">${getCategoryIcon(place.category)}</span>
                            <button class="favorite-btn text-2xl ${isFavorite ? 'favorited' : ''}" onclick="toggleFavorite('${place.name.replace(/'/g, "\\'")}')">
                                ${isFavorite ? '❤️' : '🤍'}
                            </button>
                        </div>
                    </div>
                    
                    <div class="space-y-3 mb-4">
                        <div class="flex items-center justify-between">
                            <div class="star-rating text-lg">${stars}</div>
                            <div class="text-lg font-bold text-primary">${place.rating}/5</div>
                        </div>
                        
                        <p class="text-gray-700 dark:text-gray-300 text-sm leading-relaxed">${place.description}</p>
                        
                        <div class="grid grid-cols-2 gap-3 text-sm">
                            <div class="flex items-center gap-2 text-gray-600 dark:text-gray-300">
                                <span>💰</span>
                                <span>${place.price}</span>
                            </div>
                            <div class="flex items-center gap-2 text-gray-600 dark:text-gray-300">
                                <span>📞</span>
                                <span>${place.phone}</span>
                            </div>
                            <div class="flex items-center gap-2 text-gray-600 dark:text-gray-300">
                                <span>🕒</span>
                                <span>${place.openHours}</span>
                            </div>
                            <div class="flex items-center gap-2 text-gray-600 dark:text-gray-300">
                                <span>⭐</span>
                                <span>${place.category}</span>
                            </div>
                        </div>
                        
                        ${place.specialties ? `
                            <div class="mt-3">
                                <div class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">${t.specialties}</div>
                                <div class="flex flex-wrap gap-1">
                                    ${place.specialties.map(spec => 
                                        `<span class="bg-primary/10 text-primary px-2 py-1 rounded-full text-xs">${spec}</span>`
                                    ).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="flex gap-2 mt-4">
                        <button class="flex-1 bg-primary text-white py-2 px-4 rounded-lg text-sm hover:bg-purple-700 transition-colors" onclick="callPlace('${place.phone}')">
                            ${t.call}
                        </button>
                        <button class="flex-1 bg-green-500 text-white py-2 px-4 rounded-lg text-sm hover:bg-green-600 transition-colors" onclick="sharePlace('${place.name.replace(/'/g, "\\'")}', '${place.location.replace(/'/g, "\\'")}')">
                            ${t.sharePlace}
                        </button>
                    </div>
                </div>
            `;
        }

        // Update quick stats
        function updateQuickStats(places) {
            const statsDiv = document.getElementById('quickStats');
            const avgRating = places.reduce((sum, place) => sum + place.rating, 0) / places.length;
            const estimatedCost = calculateEstimatedCost(places);
            
            document.getElementById('totalPlaces').textContent = places.length;
            document.getElementById('avgRating').textContent = avgRating.toFixed(1);
            document.getElementById('estimatedCost').textContent = estimatedCost + (currentLanguage === 'ar' ? ' دينار' : ' JD');
            
            statsDiv.classList.remove('hidden');
        }

        // Calculate estimated cost
        function calculateEstimatedCost(places) {
            const costMap = { '$': 15, '$$': 30, '$$$': 60, '$$$$': 120, 'مجاني': 0 };
            const totalCost = places.reduce((sum, place) => sum + (costMap[place.price] || 0), 0);
            return Math.round(totalCost / places.length * 2); // Estimate for 2 people
        }

        // Update favorites count
        function updateFavoritesCount() {
            document.getElementById('favoritesCount').textContent = favorites.length;
        }

        // Toggle favorite
        function toggleFavorite(placeName) {
            console.log('Toggling favorite:', placeName);
            
            if (favorites.includes(placeName)) {
                favorites = favorites.filter(fav => fav !== placeName);
            } else {
                favorites.push(placeName);
            }
            
            localStorage.setItem('favorites', JSON.stringify(favorites));
            updateFavoritesCount();
            
            // Refresh current view if results are shown
            if (!document.getElementById('results').classList.contains('hidden') && currentPlaces.length > 0) {
                displayResults(currentPlaces);
            }
        }

        // Show all places
        function showAll() {
            if (currentPlaces.length > 0) {
                displayResults(currentPlaces);
                
                // Update button states
                document.getElementById('showAllBtn').className = 'px-4 py-2 bg-primary text-white rounded-lg text-sm';
                document.getElementById('showFavoritesBtn').className = 'px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg text-sm';
            }
        }

        // Show favorites only
        function showFavorites() {
            if (currentPlaces.length > 0) {
                const favoritePlaces = currentPlaces.filter(place => favorites.includes(place.name));
                displayResults(favoritePlaces);
                
                // Update button states
                document.getElementById('showFavoritesBtn').className = 'px-4 py-2 bg-primary text-white rounded-lg text-sm';
                document.getElementById('showAllBtn').className = 'px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg text-sm';
            }
        }

        // Share results
        function shareResults() {
            const governorate = document.getElementById('governorate').value;
            const activities = selectedActivities.join(', ');
            const t = translations[currentLanguage];
            
            const text = currentLanguage === 'ar' 
                ? `🇯🇴 شوف خطة الرحلة الرهيبة هاي في ${governorate}!\n\nالفعاليات: ${activities}\n\nمن دليل الرحلات الأردني المطور`
                : `🇯🇴 Check out this amazing trip plan in ${governorate}!\n\nActivities: ${activities}\n\nFrom Jordan Travel Guide`;
            
            if (navigator.share) {
                navigator.share({
                    title: currentLanguage === 'ar' ? 'دليل الرحلات الأردني' : 'Jordan Travel Guide',
                    text: text,
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(text + '\n\n' + window.location.href);
                alert(t.linkCopied);
            }
        }

        // Share place
        function sharePlace(name, location) {
            const t = translations[currentLanguage];
            const text = currentLanguage === 'ar' 
                ? `🇯🇴 شوف المكان الرهيب هاذا: ${name}\n📍 ${location}\n\nمن دليل الرحلات الأردني`
                : `🇯🇴 Check out this amazing place: ${name}\n📍 ${location}\n\nFrom Jordan Travel Guide`;
            
            if (navigator.share) {
                navigator.share({
                    title: name,
                    text: text
                });
            } else {
                navigator.clipboard.writeText(text);
                alert(t.placeCopied);
            }
        }

        // Call place
        function callPlace(phone) {
            window.open(`tel:${phone}`);
        }

        // Reset form
        function resetForm() {
            console.log('Resetting form...');
            
            document.getElementById('governorate').value = '';
            document.getElementById('sortBy').value = 'rating';
            selectedActivities = [];
            selectedPrice = 'all';
            currentPlaces = [];
            
            // Reset activity cards
            document.querySelectorAll('.activity-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Reset price filters
            document.querySelectorAll('.price-filter').forEach(filter => {
                filter.classList.remove('active');
            });
            document.querySelector('.price-filter[data-price="all"]').classList.add('active');
            
            // Hide results
            document.getElementById('results').classList.add('hidden');
            document.getElementById('quickStats').classList.add('hidden');
        }

        // Scroll to top
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Setup scroll button
        function setupScrollButton() {
            window.addEventListener('scroll', () => {
                const scrollBtn = document.getElementById('scrollTopBtn');
                if (window.pageYOffset > 300) {
                    scrollBtn.classList.remove('hidden');
                } else {
                    scrollBtn.classList.add('hidden');
                }
            });
        }

        // Get category icon
        function getCategoryIcon(category) {
            const icons = {
                'مطاعم': '🍽️',
                'كافيهات': '☕',
                'ألعاب': '🎮',
                'مغامرات': '🏔️',
                'تسوق': '🛍️',
                'ثقافية': '🏛️'
            };
            return icons[category] || '📍';
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('صفحة محملة، تهيئة...');
            setLanguage(currentLanguage);
            updateFavoritesCount();
            setupScrollButton();
        });
    </script>
</body>
</html>